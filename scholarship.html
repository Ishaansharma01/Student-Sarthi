<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scholarship Portal</title>
  <link rel="stylesheet" href="Scholarshipstyle.css">
</head>

<body>
  <!-- Navbar -->
  <nav>
    <h1>Student sarthi</h1>
    <button class="menu-toggle" id="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
    <ul id="menu">
      <li><a href="main.html">Home</a></li>
       <li><a href="#">Careers</a></li>
      <li><a href="courses.html">Courses</a></li>
      <li><a href="scholarship.html">Scholarships</a></li>
      
      <!-- üåó Dark Mode Toggle -->
      <button id="theme-toggle" class="theme-btn">üåô</button>
    </li>
    </ul>
  </nav>
<!-- Hero with Slider -->
<section class="hero" id="home">
  <div class="slider">
    <div class="slide active" style="background-image: url('https://hips.hearstapps.com/hmg-prod/images/graduation-captions-lead-image-6412222f98500.jpg?crop=1xw:0.8423586572438162xh;0,0');"></div>
    <div class="slide" style="background-image: url('https://registrar.utdallas.edu/files/2024/09/AUC-13.jpg');"></div>
    <div class="slide" style="background-image: url('https://www.vancopayments.com/hs-fs/hubfs/Graduation%20-%20Cap%20throw.png?width=1640&height=924&name=Graduation%20-%20Cap%20throw.png');"></div>
  </div>
  <div class="hero-text">
    <h2>Find Scholarships Easily</h2>
    <p>Helping students connect with opportunities across India and abroad</p>
    <button class="btn explore-btn" onclick="scrollToHighlights()">Explore Scholarships</button>
  </div>
</section>
<!-- 3 Highlight Cards with Dropdown (Hover) -->
<section class="highlight-cards">
  <div class="highlight-card">
    <h3>üèõÔ∏è State Scholarships</h3>
    <p>Financial aid provided by state governments across India.</p>
    <ul class="dropdown-list">
      <li><a href="https://scholarships.gov.in/" target="_blank">MP Post Matric Scholarship</a></li>
      <li><a href="https://scholarship.up.gov.in/" target="_blank">UP Pre-Matric Scholarship</a></li>
      <li><a href="https://mahadbt.maharashtra.gov.in/" target="_blank">Maharashtra Open Merit Scholarship</a></li>
    </ul>
  </div>
  <div class="highlight-card">
    <h3>üè´ School Scholarships</h3>
    <p>Scholarships for meritorious school students.</p>
    <ul class="dropdown-list">
      <li><a href="https://scholarships.gov.in/" target="_blank">National Means-cum-Merit Scholarship</a></li>
      <li><a href="https://www.cbse.gov.in/" target="_blank">CBSE Merit Scholarship</a></li>
      <li><a href="https://kvpy.iisc.ac.in/" target="_blank">KVPY Fellowship</a></li>
    </ul>
  </div>
  <div class="highlight-card">
    <h3>üåè Abroad Scholarships</h3>
    <p>Opportunities for studying in foreign universities.</p>
    <ul class="dropdown-list">
      <li><a href="https://www.usief.org.in/" target="_blank">Fulbright-Nehru Scholarship</a></li>
      <li><a href="https://www.chevening.org/" target="_blank">Chevening Scholarship</a></li>
      <li><a href="https://www.daad.de/en/" target="_blank">DAAD Scholarship (Germany)</a></li>
    </ul>
  </div>
</section>

<!-- Move the search bar here, after highlight-cards and before state-scholarships -->
<section style="text-align:center; margin: 30px 0;">
  <input type="text" id="scholarship-search" placeholder="Search scholarships..." style="padding:10px 18px; border-radius:8px; border:1.5px solid #4a148c; width: 260px; font-size:1rem;">
</section>

<!-- State Scholarships Section -->
<section class="state-scholarships">
  <h2>State Scholarships</h2>
  <p style="color:#555; margin-bottom:18px; font-size:1.08rem;">Select your state to discover scholarships available for you.</p>
  <div class="state-arrow">
    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 5v14m0 0l-7-7m7 7l7-7" stroke="#4a148c" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="state-box">
    <label for="state">Choose State:</label>
    <select id="state" onchange="filterScholarships()">
      <option value="">--Select--</option>
      <option value="Andhra Pradesh">Andhra Pradesh</option>
      <option value="Arunachal Pradesh">Arunachal Pradesh</option>
      <option value="Assam">Assam</option>
      <option value="Bihar">Bihar</option>
      <option value="Chhattisgarh">Chhattisgarh</option>
      <option value="Goa">Goa</option>
      <option value="Gujarat">Gujarat</option>
      <option value="Haryana">Haryana</option>
      <option value="Himachal Pradesh">Himachal Pradesh</option>
      <option value="Jharkhand">Jharkhand</option>
      <option value="Karnataka">Karnataka</option>
      <option value="Kerala">Kerala</option>
      <option value="Madhya Pradesh">Madhya Pradesh</option>
      <option value="Maharashtra">Maharashtra</option>
      <option value="Manipur">Manipur</option>
      <option value="Meghalaya">Meghalaya</option>
      <option value="Mizoram">Mizoram</option>
      <option value="Nagaland">Nagaland</option>
      <option value="Odisha">Odisha</option>
      <option value="Punjab">Punjab</option>
      <option value="Rajasthan">Rajasthan</option>
      <option value="Sikkim">Sikkim</option>
      <option value="Tamil Nadu">Tamil Nadu</option>
      <option value="Telangana">Telangana</option>
      <option value="Tripura">Tripura</option>
      <option value="Uttar Pradesh">Uttar Pradesh</option>
      <option value="Uttarakhand">Uttarakhand</option>
      <option value="West Bengal">West Bengal</option>
      <!-- Union Territories -->
      <option value="Delhi">Delhi</option>
      <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
      <option value="Chandigarh">Chandigarh</option>
      <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra & Nagar Haveli and Daman & Diu</option>
      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
      <option value="Ladakh">Ladakh</option>
      <option value="Lakshadweep">Lakshadweep</option>
      <option value="Puducherry">Puducherry</option>
    </select>
  </div>
</section>
 <!-- Container for Scholarships -->
  <section id="state-scholarships-list" class="scholarship-list"></section>

  <!-- Scholarships -->
  <section class="scholarships">

    <!-- Madhya Pradesh (3 Scholarships) -->
    <div class="card" data-state="Madhya Pradesh" data-id="mp-post-matric">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>MP Post Matric Scholarship</h3>
      <p>For SC/ST/OBC students pursuing UG/PG. <br> Deadline: 25 Oct 2025</p>
      <a href="https://hescholarship.mp.gov.in/Public/OtherSchemes/GB.aspx?ID=MTM=" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
      <button class="upvote-btn" onclick="upvoteScholarship('mp-post-matric', this)" style="margin-top:10px;background:#ffca28;color:#4a148c;border:none;border-radius:8px;padding:6px 16px;font-weight:600;cursor:pointer;">
        üëç Upvote <span class="upvote-count">0</span>
      </button>
    </div>
    <div class="card" data-state="Madhya Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Gaon Ki Beti Scholarship (MP)</h3>
      <p>For rural girl students who passed Class 12 with first division. <br> Deadline: 15 Nov 2025</p>
      <a href="https://hescholarship.mp.gov.in/Public/Check_EKYC.aspx?ID=Mw==" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Madhya Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Mukhyamantri Medhavi Vidyarthi Yojna (MMVY)</h3>
      <p>For meritorious students entering undergraduate courses. <br> Deadline: 19 Sept 2025</p>
      <a href="https://www.medhavikalyan.mp.gov.in/MMVY.aspx" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Madhya Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Mukhyamantri Jankalyan (Shiksha protshan) Yojna (MMJKY)</h3>
      <p>For meritorious students entering undergraduate courses. <br> Deadline: 20 Sept 2025</p>
      <a href="https://www.medhavikalyan.mp.gov.in/sambalscholarship/default.aspx#" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <!-- Other states (sample scholarships, expand later) -->
    </div>
    <div class="card" data-state="Madhya Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Reliance Foundation Undergraduate scholarship</h3>
      <p>For UG students<br> Deadline: 04 Oct 2025</p>
      <a href="https://scholarships.reliancefoundation.org/UG_Scholarship.aspx#divclickheretoapply" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div> 
    <div class="card" data-state="Maharashtra">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Infosys foundation stem stars scholarship 2025-26</h3>
      <p>Students must be enrolled in first-year undergraduate courses at reputable (NIRF-accredited) institutions in STEM-related courses. <br> Deadline: 15 Sept 2025</p>
      <a href="https://www.buddy4study.com/application/ISTS3/instruction" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Maharashtra">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>NSP Post-Matric Scholarship Scheme for ST Students, Jammu and Kashmir 2025-26</h3>
      <p>Post-Matric Scholarship Scheme for ST Students, Jammu and Kashmir 2025-26 is an initiative for ST students of the state pursuing higher studies after completing Class 10. <br> Deadline: 15 Sept 2025</p>
      <a href="https://scholarships.gov.in/" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    </div>
    <div class="card" data-state="Madhya Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Reliance Foundation Postgraduate scholarship</h3>
      <p>For PG students<br> Deadline: 04 Oct 2025</p>
      <a href="https://scholarships.reliancefoundation.org/PG_Scholarship.aspx#divclickheretoapply" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Karnataka">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Karnataka Merit Scholarship</h3>
      <p>For UG students. <br> Deadline: 15 Oct 2025</p>
      <a href="https://ssp.karnataka.gov.in/" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Delhi">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Delhi Minority Scholarship</h3>
      <p>For minority students. <br> Deadline: 20 Sept 2025</p>
      <a href="https://dmc.delhi.gov.in/dmc/welfare-schemes" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Tamil Nadu">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>Tamil Nadu Education Scholarship</h3>
      <p>For PG students. <br> Deadline: 10 Oct 2025</p>
      <a href="https://tndce.tn.gov.in/Home/scholarship" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>
    <div class="card" data-state="Uttar Pradesh">
      <img src="https://img.icons8.com/color/96/000000/graduation-cap.png" alt="Scholarship" class="scholarship-img">
      <h3>UP Pre-Matric Scholarship</h3>
      <p>For students of Class 9 & 10. <br> Deadline: 12 Oct 2025</p>
      <a href="#" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
    </div>

    <!-- You can keep adding similar blocks for each state -->
  </section>

  <!-- Reviews Section -->
  <section class="reviews" style="background:#f3e5f5; padding:40px 0; text-align:center;">
    <h2 style="color:#4a148c; margin-bottom:30px;">What Our Users Say</h2>
    <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:24px;">
      <div class="card review-card" style="max-width:320px; min-width:220px;">
        <img src="https://randomuser.me/api/portraits/women/68.jpg" alt="Priya Sharma" class="review-img" style="width:60px;height:60px;border-radius:50%;margin-bottom:10px;object-fit:cover;">
        <h3>Priya Sharma</h3>
        <p>"This portal helped me find the perfect scholarship for my studies. The process was easy and quick!"</p>
      </div>
      <div class="card review-card" style="max-width:320px; min-width:220px;">
        <img src="https://randomuser.me/api/portraits/men/65.jpg" alt="Rahul Verma" class="review-img" style="width:60px;height:60px;border-radius:50%;margin-bottom:10px;object-fit:cover;">
        <h3>Rahul Verma</h3>
        <p>"I love the user-friendly interface and the up-to-date information. Highly recommended for all students!"</p>
      </div>
      <div class="card review-card" style="max-width:320px; min-width:220px;">
        <img src="https://randomuser.me/api/portraits/women/43.jpg" alt="Anjali Singh" class="review-img" style="width:60px;height:60px;border-radius:50%;margin-bottom:10px;object-fit:cover;">
        <h3>Anjali Singh</h3>
        <p>"Thanks to this website, I secured a scholarship for my higher education. Thank you so much!"</p>
      </div>
    </div>
  </section>

  <!-- Feedback Form Section -->
<section class="feedback-section" style="background:#fff; padding:36px 0; text-align:center;">
  <h2 style="color:#4a148c; margin-bottom:18px;">We Value Your Feedback</h2>
  <form id="feedback-form" style="max-width:400px;margin:0 auto;">
    <textarea id="feedback-text" rows="4" placeholder="Share your experience or suggestions..." style="width:100%;padding:12px;border-radius:8px;border:1.5px solid #b39ddb;margin-bottom:12px;font-size:1rem;"></textarea>
    <br>
    <button type="submit" class="btn" style="width:100%;">Submit Feedback</button>
    <div id="feedback-message" style="margin-top:10px;color:#388e3c;font-weight:600;display:none;">Thank you for your feedback!</div>
  </form>
</section>

  <!-- About -->
  <section class="about" id="about">
    <h2>About Us</h2>
    <p>We aim to bridge the gap between students and opportunities by providing updated scholarship information for all states and union territories of India.</p>
  </section>

  <!-- Footer -->
  <footer id="contact">
    <p>&copy; 2025 Scholarship Portal | All Rights Reserved</p>
  </footer>

  <script>
    function filterScholarships() {
      const state = document.getElementById("state").value;
      const cards = document.querySelectorAll(".card");
      cards.forEach(card => {
        if (state === "" || card.getAttribute("data-state") === state) {
          card.style.display = "block";
        } else {
          card.style.display = "none";
        }
      });
    }

    function toggleMenu() {
      document.getElementById("menu").classList.toggle("active");
    }

    function scrollToHighlights() {
      const section = document.querySelector('.highlight-cards');
      if(section) section.scrollIntoView({ behavior: 'smooth' });
    }

    function showCategory(category) {
      const container = document.getElementById("scholarship-list");
      container.innerHTML = `<h2>${category.charAt(0).toUpperCase() + category.slice(1)} Scholarships</h2>`;
      scholarshipsData[category].forEach(sch => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${sch.title}</h3>
          <p>${sch.desc}<br><strong>Deadline:</strong> ${sch.deadline}</p>
          <a href="${sch.link}" class="btn" target="_blank" rel="noopener noreferrer">Apply Now</a>
        `;
        container.appendChild(card);
      });
      container.scrollIntoView({ behavior: "smooth" });
    }

    // Hero Slider Auto Change
    let slideIndex = 0;
    const slides = document.querySelectorAll(".slide");
    function showSlides() {
      slides.forEach((slide, i) => {
        slide.classList.remove("active");
      });
      slideIndex = (slideIndex + 1) % slides.length;
      slides[slideIndex].classList.add("active");
    }
    setInterval(showSlides, 4000); // change every 4 seconds

    // Navbar toggle for mobile
    const menuToggle = document.getElementById("menu-toggle");
    const menu = document.getElementById("menu");
    menuToggle.addEventListener("click", () => {
      menu.classList.toggle("active");
    });

    // Scholarship search filter
    document.getElementById('scholarship-search').addEventListener('input', function() {
      const query = this.value.toLowerCase();
      document.querySelectorAll('.scholarships .card').forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = text.includes(query) ? 'block' : 'none';
      });
    });

    // Save theme preference
    const themeToggle = document.getElementById('theme-toggle');
    function setTheme(mode) {
      if (mode === 'dark') {
        document.documentElement.classList.add('dark-mode');
        themeToggle.textContent = 'Light Mode';
        localStorage.setItem('theme', 'dark');
      } else {
        document.documentElement.classList.remove('dark-mode');
        themeToggle.textContent = 'Dark Mode';
        localStorage.setItem('theme', 'light');
      }
    }
    themeToggle.onclick = function() {
      setTheme(document.documentElement.classList.contains('dark-mode') ? 'light' : 'dark');
    };
    // On load, set theme from localStorage
    setTheme(localStorage.getItem('theme') === 'dark' ? 'dark' : 'light');

    // Feedback form logic
    document.getElementById('feedback-form').addEventListener('submit', function(e) {
      e.preventDefault();
      // Optionally, send feedback to server here
      document.getElementById('feedback-message').style.display = 'block';
      document.getElementById('feedback-text').value = '';
      setTimeout(() => {
        document.getElementById('feedback-message').style.display = 'none';
      }, 2500);
    });

    // Upvote logic for scholarships
    function upvoteScholarship(id, btn) {
      let upvotes = parseInt(localStorage.getItem('upvote_' + id) || '0', 10);
      upvotes += 1;
      localStorage.setItem('upvote_' + id, upvotes);
      btn.querySelector('.upvote-count').textContent = upvotes;
      btn.disabled = true;
      btn.style.opacity = 0.7;
      btn.textContent = 'üëç Upvoted ' + upvotes;
    }

    // Initialize upvote counts and disable if already upvoted
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.card[data-id]').forEach(card => {
        const id = card.getAttribute('data-id');
        const btn = card.querySelector('.upvote-btn');
        const count = parseInt(localStorage.getItem('upvote_' + id) || '0', 10);
        btn.querySelector('.upvote-count').textContent = count;
        if (localStorage.getItem('upvote_' + id)) {
          btn.disabled = true;
          btn.style.opacity = 0.7;
          btn.textContent = 'üëç Upvoted ' + count;
        }
      });
    });

    // =====================
    // Closing-soon notifier
    // =====================
    (function setupClosingSoonNotifier(){
      // Config
      const THRESHOLD_DAYS = 10; // notify if deadline within N days
      const MAX_ITEMS = 4; // show up to N notifications

      // Create toast container once
      function ensureToastContainer(){
        let box = document.getElementById('closing-soon-toasts');
        if (!box) {
          box = document.createElement('div');
          box.id = 'closing-soon-toasts';
          box.style.position = 'fixed';
          box.style.top = '80px'; // below navbar
          box.style.right = '20px';
          box.style.zIndex = '9998';
          box.style.width = '320px';
          box.style.maxWidth = '90vw';
          box.style.display = 'none';
          document.body.appendChild(box);
        }
        return box;
      }

      function monthIndex(token){
        const m = token.toLowerCase();
        const map = {jan:0, feb:1, mar:2, apr:3, may:4, jun:5, jul:6, aug:7, sep:8, sept:8, oct:9, nov:10, dec:11, january:0, february:1, march:2, april:3, june:5, july:6, august:7, september:8, october:9, november:10, december:11};
        return map[m];
      }

      function parseDeadline(text){
        // Expect formats like "Deadline: 25 Oct 2025" or "04 Sept 2025"
        const m = text.match(/Deadline:\s*(\d{1,2})\s*([A-Za-z]+)\s*(\d{4})/i);
        if (!m) return null;
        const day = parseInt(m[1], 10);
        const mon = monthIndex(m[2]);
        const year = parseInt(m[3], 10);
        if (isNaN(day) || mon == null || isNaN(year)) return null;
        return new Date(year, mon, day);
      }

      function daysUntil(date){
        const ms = date.getTime() - new Date().setHours(0,0,0,0);
        return Math.ceil(ms / (1000*60*60*24));
      }

      function collectClosingSoon(){
        const cards = Array.from(document.querySelectorAll('.scholarships .card'));
        const items = [];
        for (const card of cards) {
          if (card.style.display === 'none') continue; // respect current filters
          const titleEl = card.querySelector('h3');
          const pEl = card.querySelector('p');
          if (!titleEl || !pEl) continue;
          const deadline = parseDeadline(pEl.innerText || '');
          if (!deadline) continue;
          const days = daysUntil(deadline);
          if (days >= 0 && days <= THRESHOLD_DAYS) {
            items.push({card, title: titleEl.innerText.trim(), deadline, days});
          }
        }
        // sort ascending by days
        items.sort((a,b) => a.days - b.days || a.title.localeCompare(b.title));
        return items;
      }

      function renderToasts(items){
        const box = ensureToastContainer();
        box.innerHTML = '';
        if (!items.length) { box.style.display = 'none'; return; }

        const wrapper = document.createElement('div');
        wrapper.style.background = '#ffffff';
        wrapper.style.border = '1.5px solid #4a148c';
        wrapper.style.borderRadius = '12px';
        wrapper.style.boxShadow = '0 8px 24px rgba(0,0,0,0.15)';
        wrapper.style.overflow = 'hidden';

        const header = document.createElement('div');
        header.style.display = 'flex';
        header.style.justifyContent = 'space-between';
        header.style.alignItems = 'center';
        header.style.padding = '10px 12px';
        header.style.background = '#f3e5f5';
        header.style.color = '#4a148c';
        header.style.fontWeight = '700';
        header.textContent = 'Closing soon (‚â§ ' + THRESHOLD_DAYS + ' days)';

        const closeBtn = document.createElement('button');
        closeBtn.textContent = '√ó';
        closeBtn.setAttribute('aria-label', 'Dismiss');
        closeBtn.style.background = 'transparent';
        closeBtn.style.border = 'none';
        closeBtn.style.fontSize = '1.2rem';
        closeBtn.style.cursor = 'pointer';
        closeBtn.onclick = () => { box.style.display = 'none'; };
        header.appendChild(closeBtn);

        const list = document.createElement('div');
        list.style.maxHeight = '50vh';
        list.style.overflowY = 'auto';

        items.slice(0, MAX_ITEMS).forEach(item => {
          const row = document.createElement('div');
          row.style.display = 'flex';
          row.style.justifyContent = 'space-between';
          row.style.alignItems = 'center';
          row.style.padding = '10px 12px';
          row.style.borderTop = '1px solid #eee';

          const text = document.createElement('div');
          text.innerHTML = `<strong>${item.title}</strong><br><span style="color:#555;">${item.days === 0 ? 'Today' : item.days + ' days left'}</span>`;
          row.appendChild(text);

          const btn = document.createElement('button');
          btn.textContent = 'View';
          btn.className = 'btn';
          btn.style.padding = '6px 10px';
          btn.style.fontSize = '0.9rem';
          btn.onclick = () => { item.card.scrollIntoView({behavior:'smooth', block:'center'}); item.card.style.outline = '2px solid #ffca28'; setTimeout(()=> item.card.style.outline = '', 1400); };
          row.appendChild(btn);

          list.appendChild(row);
        });

        if (items.length > MAX_ITEMS) {
          const more = document.createElement('div');
          more.style.padding = '8px 12px';
          more.style.borderTop = '1px solid #eee';
          more.style.color = '#555';
          more.textContent = `+ ${items.length - MAX_ITEMS} more‚Ä¶`;
          list.appendChild(more);
        }

        wrapper.appendChild(header);
        wrapper.appendChild(list);
        box.appendChild(wrapper);
        box.style.display = 'block';
      }

      function updateToasts(){
        const items = collectClosingSoon();
        renderToasts(items);
        annotateBadges(items);
      }

      // Add small badges to cards and highlight by urgency
      function annotateBadges(items){
        const allCards = Array.from(document.querySelectorAll('.scholarships .card'));
        // Clear previous badges and outlines
        allCards.forEach(card => {
          card.querySelectorAll('.closing-badge').forEach(b => b.remove());
          card.style.outline = '';
        });

        if (!items || !items.length) return;

        items.forEach(({card, days}) => {
          // Ensure positioning
          if (!card.style.position) card.style.position = 'relative';
          const badge = document.createElement('div');
          badge.className = 'closing-badge';
          const urgent = days <= 3;
          const soon = days <= 7;
          const bg = urgent ? '#ef4444' : soon ? '#f59e0b' : '#ffca28';
          const text = days === 0 ? 'Today' : `${days}d left`;
          // Badge styles
          Object.assign(badge.style, {
            position: 'absolute',
            top: '10px',
            right: '10px',
            background: bg,
            color: '#111',
            fontWeight: '700',
            fontSize: '0.75rem',
            padding: '4px 8px',
            borderRadius: '999px',
            boxShadow: '0 2px 6px rgba(0,0,0,0.15)',
            zIndex: '1'
          });
          badge.textContent = text;
          card.appendChild(badge);
          // Highlight outline
          card.style.outline = `2px solid ${bg}`;
        });
      }

      // Run on load
      document.addEventListener('DOMContentLoaded', function(){
        // Only show once per session
        if (!sessionStorage.getItem('closingSoonShown')) {
          updateToasts();
          sessionStorage.setItem('closingSoonShown', '1');
        }
      });

      // Recompute on state change and search input
      const stateSel = document.getElementById('state');
      if (stateSel) stateSel.addEventListener('change', () => setTimeout(updateToasts, 0));
      const searchBox = document.getElementById('scholarship-search');
      if (searchBox) searchBox.addEventListener('input', () => setTimeout(updateToasts, 200));
    })();

  // Chatbot logic
  function toggleChatbot() {
    const win = document.getElementById('chatbot-window');
    win.style.display = win.style.display === 'block' ? 'none' : 'block';
    if (win.style.display === 'block') {
      setTimeout(() => {
        document.getElementById('chatbot-input').focus();
      }, 200);
    }
  }

  // Simple Q&A pairs
  const chatbotAnswers = [
    { q: /hello|hi|hey/i, a: "Hello! How can I help you with scholarships today?" },
    { q: /find.*scholarship|search.*scholarship/i, a: "You can use the search bar above the scholarships section to find scholarships by keyword." },
    { q: /state.*scholarship/i, a: "Select your state in the 'State Scholarships' section to see scholarships available for your region." },
    { q: /how.*apply/i, a: "Click the 'Apply Now' button on any scholarship card to visit the official application page." },
    { q: /deadline/i, a: "Each scholarship card displays its deadline. Please check the card details." },
    { q: /contact|support/i, a: "You can reach us via the contact section at the bottom of the page." },
    { q: /dark.*mode|light.*mode/i, a: "Use the 'Dark Mode' or 'Light Mode' button in the navbar to switch themes." },
    { q: /feedback/i, a: "We value your feedback! Please use the feedback form below the reviews section." },
    { q: /.*/, a: "Sorry, I didn't understand that. Please ask about scholarships, application process, or site features." }
  ];

  function chatbotReply(msg) {
    for (let pair of chatbotAnswers) {
      if (pair.q.test(msg)) return pair.a;
    }
    return chatbotAnswers[chatbotAnswers.length - 1].a;
  }

  // Initialize chatbot once DOM is ready so elements exist
  document.addEventListener('DOMContentLoaded', function() {
    const chatbotForm = document.getElementById('chatbot-form');
    const chatbotInput = document.getElementById('chatbot-input');
    const chatbotMessages = document.getElementById('chatbot-messages');
    if (!chatbotForm || !chatbotInput || !chatbotMessages) return;

    chatbotForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const userMsg = chatbotInput.value.trim();
      if (!userMsg) return;
      chatbotMessages.innerHTML += `<div style="margin-bottom:8px;text-align:right;"><span style="background:#e1bee7;color:#222;padding:7px 14px;border-radius:16px 16px 2px 16px;display:inline-block;">${userMsg}</span></div>`;
      chatbotInput.value = '';
      setTimeout(() => {
        const reply = chatbotReply(userMsg);
        chatbotMessages.innerHTML += `<div style="margin-bottom:8px;text-align:left;"><span style="background:#4a148c;color:#fff;padding:7px 14px;border-radius:16px 16px 16px 2px;display:inline-block;">${reply}</span></div>`;
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
      }, 600);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    });
  });
  </script>
  <!-- Floating Chatbot Button and Window -->
<div id="chatbot-btn" style="position:fixed;bottom:32px;right:32px;z-index:9999;">
  <button onclick="toggleChatbot()" style="background:#4a148c;color:#fff;border:none;border-radius:50%;width:56px;height:56px;box-shadow:0 2px 8px rgba(0,0,0,0.18);font-size:2rem;cursor:pointer;transition:background 0.3s;">üí¨</button>
</div>
<div id="chatbot-window" style="display:none;position:fixed;bottom:100px;right:32px;width:320px;max-width:90vw;background:#fff;border-radius:16px;box-shadow:0 4px 24px rgba(74,20,140,0.18);z-index:10000;overflow:hidden;">
  <div style="background:#4a148c;color:#fff;padding:14px 18px;font-weight:600;display:flex;justify-content:space-between;align-items:center;">
    <span>Ask Sarthi</span>
    <button onclick="toggleChatbot()" style="background:none;border:none;color:#fff;font-size:1.2rem;cursor:pointer;">‚úñ</button>
  </div>
  <div id="chatbot-messages" style="padding:14px 12px;height:220px;overflow-y:auto;font-size:1rem;background:#faf7fd;"></div>
  <form id="chatbot-form" style="display:flex;border-top:1px solid #eee;">
    <input id="chatbot-input" type="text" placeholder="Ask a question..." autocomplete="off" style="flex:1;padding:10px 12px;border:none;font-size:1rem;background:#f3e5f5;">
    <button type="submit" style="background:#4a148c;color:#fff;border:none;padding:0 18px;font-size:1.1rem;cursor:pointer;">‚û§</button>
  </form>
</div>
  <script src="script.js"></script>
</body>
</html>
